<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recommandeur d'Outils IA</title>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <script src="config.js"></script>

    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore-compat.js"></script>
</head>

<body class="bg-gray-50 min-h-screen p-8">
    <div class="max-w-2xl mx-auto bg-white rounded-lg shadow-lg p-8">
        
        <h1 class="text-4xl font-bold text-gray-900 mb-2">Trouvez l'outil IA parfait</h1>
        <p class="text-gray-600 mb-8">R√©pondez √† 3 questions simples et d√©couvrez l'outil qui vous correspond</p>

        <form class="space-y-6">
            <div>
                <label for="domaine" class="block text-sm font-semibold text-gray-700 mb-3">
                    1. Quel est votre domaine d'utilisation ?
                </label>
                <select id="domaine" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">-- Choisir --</option>
                    <option value="redaction">R√©daction & Texte</option>
                    <option value="images">Images & Design</option>
                    <option value="video">Vid√©o & Avatar</option>
                    <option value="audio">Audio & Voix</option>
                    <option value="automatisation">Automatisation</option>
                    <option value="developpement">D√©veloppement</option>
                </select>
            </div>

            <div>
                <label for="technicite" class="block text-sm font-semibold text-gray-700 mb-3">
                    2. Quel est votre niveau de technicit√© ?
                </label>
                <select id="technicite" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">-- Choisir --</option>
                    <option value="debutant">D√©butant</option>
                    <option value="intermediaire">Interm√©diaire</option>
                    <option value="expert">Expert</option>
                </select>
            </div>

            <div>
                <label for="temps" class="block text-sm font-semibold text-gray-700 mb-3">
                    3. Combien de temps pouvez-vous y consacrer ?
                </label>
                <select id="temps" class="w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-transparent">
                    <option value="">-- Choisir --</option>
                    <option value="rapide">Rapide (< 1h)</option>
                    <option value="moyen">Moyen (1-5h)</option>
                    <option value="long">Long (5h+)</option>
                </select>
            </div>

            <button id="bouton" type="button" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 rounded-md transition">
                Voir ma recommandation
            </button>

            <div id="resultat" class="mt-8 p-6 bg-green-50 border border-green-200 rounded-lg hidden">
                <h2 class="text-2xl font-bold text-green-900 mb-2">Voil√† ta recommandation !</h2>
                <div id="texte-resultat" class="text-gray-700"></div>
            </div>
        </form>
    </div>

    <script>
    // 1. INITIALISATION
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // 2. CHARGEMENT DES DONN√âES DEPUIS FIRESTORE
    let outils = [];
    db.collection('outils').get().then((snapshot) => {
            outils = [];
            snapshot.forEach(doc => {
                outils.push(doc.data());
            });
            console.log('‚úÖ Outils charg√©s :', outils.length);
        })
        .catch(error => console.error('‚ùå Erreur Firestore :', error));

    // 3. L'ALGORITHME DE RECOMMANDATION
    function recommander(domaine, technicite, temps) {
        let categorieMapping = {
            'redaction': 'Texte & R√©daction',
            'images': 'Images & Design',
            'video': 'Vid√©o & Avatar',
            'audio': 'Audio & Voix',
            'automatisation': 'Automatisation',
            'developpement': 'D√©veloppement'
        };

        const complexite_max = {
            'debutant': 3,
            'intermediaire': 6,
            'expert': 10
        };

        let categorie_attendue = categorieMapping[domaine];
        
        // Filtrage
        let outils_recommandes = outils.filter(outil => {
            return outil.category === categorie_attendue && 
                   outil.complexity <= complexite_max[technicite];
        });

        // Tri par score de qualit√© ou votes
        outils_recommandes.sort((a, b) => (b.votes || 0) - (a.votes || 0));

        return outils_recommandes.slice(0, 3);
    }

    // 4. √âCOUTEUR DU BOUTON
    const bouton = document.getElementById('bouton');
    const resultat = document.getElementById('resultat');
    const texteResultat = document.getElementById('texte-resultat');

    bouton.addEventListener('click', function() {
        const domaine = document.getElementById('domaine').value;
        const technicite = document.getElementById('technicite').value;
        const temps = document.getElementById('temps').value;

        if (!domaine || !technicite || !temps) {
            alert('‚ö†Ô∏è Merci de r√©pondre √† toutes les questions !');
            return;
        }

        const recommandations = recommander(domaine, technicite, temps);

        if (recommandations.length === 0) {
            texteResultat.innerHTML = "‚ùå Aucun outil trouv√© pour vos crit√®res.";
        } else {
            let html = "<h3 class='text-xl font-bold mb-4 text-blue-900'>üéØ Top outils recommand√©s :</h3>";
            recommandations.forEach(outil => {
                html += `
                    <div class="mb-4 p-4 bg-white border border-blue-200 rounded-lg shadow-sm">
                        <p class="font-bold text-lg text-blue-900">${outil.name}</p>
                        <p class="text-sm text-gray-700 my-2">${outil.description}</p>
                        <div class="flex justify-between items-center mt-3">
                            <span class="text-xs font-medium bg-gray-100 px-2 py-1 rounded">Complexit√©: ${outil.complexity}/10</span>
                            <a href="${outil.website}" target="_blank" class="text-blue-600 font-bold text-sm hover:underline">Voir le site ‚Üí</a>
                        </div>
                    </div>
                `;
            });
            texteResultat.innerHTML = html;
        }
        resultat.classList.remove('hidden');
    });
    </script>
</body>
</html>